<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Candy Crush Ultra - Bhai Special</title>
    <style>
        /* Pro Gradient Background */
        body { 
            background: linear-gradient(-45deg, #ee7752, #e73c7e, #23a6d5, #23d5ab);
            background-size: 400% 400%; animation: gradient 10s ease infinite;
            margin: 0; display: flex; flex-direction: column; height: 100vh;
            font-family: 'Arial Black', sans-serif; overflow: hidden; touch-action: none; color: white;
        }
        @keyframes gradient { 0% { background-position: 0% 50%; } 50% { background-position: 100% 50%; } 100% { background-position: 0% 50%; } }

        /* Glowing Score Board */
        .header {
            height: 12vh; width: 100%; display: flex; justify-content: center; align-items: center;
            background: rgba(0, 0, 0, 0.3); backdrop-filter: blur(10px); border-bottom: 2px solid gold;
        }
        #score-container { text-align: center; text-shadow: 0 0 10px gold; }
        #score { font-size: 45px; font-weight: 900; color: #fff; }

        /* Full Grid */
        .grid { 
            flex-grow: 1; display: grid; grid-template-columns: repeat(8, 1fr); 
            grid-template-rows: repeat(10, 1fr); width: 100vw; gap: 4px; padding: 10px;
            box-sizing: border-box; position: relative;
        }

        .candy { 
            display: flex; align-items: center; justify-content: center; font-size: 32px;
            transition: all 0.2s cubic-bezier(0.175, 0.885, 0.32, 1.275); user-select: none;
        }

        /* Message Styles */
        #message { 
            position: absolute; top: 40%; left: 50%; transform: translate(-50%, -50%);
            font-size: 70px; font-weight: 900; color: #fff; z-index: 100;
            text-shadow: 0 0 30px #ff007f; display: none; pointer-events: none;
            animation: popOut 0.7s ease-out;
        }
        @keyframes popOut { 0% { transform: scale(0.1); opacity: 0; } 50% { transform: scale(1.3); opacity: 1; } 100% { transform: scale(1); opacity: 0; } }
    </style>
</head>
<body>

    <div class="header">
        <div id="score-container">
            <div style="font-size: 14px; letter-spacing: 3px;">TOTAL SCORE</div>
            <div id="score">0</div>
        </div>
    </div>

    <div id="message">NICE! ‚ú®</div>
    <div class="grid" id="grid"></div>

    <script>
        const grid = document.getElementById('grid');
        const scoreDisplay = document.getElementById('score');
        const msg = document.getElementById('message');
        const width = 8, height = 10;
        const emojis = ['üç¨', 'üç≠', 'üçì', 'üçá', 'üçí', 'üíé'];
        const words = ['NICE!', 'SWEET!', 'WOW!', 'AMAZING!'];
        let squares = [], score = 0;

        function createBoard() {
            for (let i = 0; i < width * height; i++) {
                const square = document.createElement('div');
                square.className = 'candy';
                square.setAttribute('id', i);
                square.innerHTML = emojis[Math.floor(Math.random() * emojis.length)];
                grid.appendChild(square);
                squares.push(square);
                square.addEventListener('touchstart', tStart);
                square.addEventListener('touchend', tEnd);
            }
        }

        let sX, sY, dId;
        function tStart(e) { dId = parseInt(this.id); sX = e.touches.clientX; sY = e.touches.clientY; this.style.transform = "scale(0.8)"; }

        function tEnd(e) {
            this.style.transform = "scale(1)";
            let eX = e.changedTouches.clientX, eY = e.changedTouches.clientY;
            let dX = eX - sX, dY = eY - sY, tId = dId;

            if (Math.abs(dX) > Math.abs(dY)) {
                if (dX > 40 && dId % width !== width - 1) tId = dId + 1;
                else if (dX < -40 && dId % width !== 0) tId = dId - 1;
            } else {
                if (dY > 40 && dId + width < width * height) tId = dId + width;
                else if (dY < -30 && dId - width >= 0) tId = dId - width;
            }

            if (tId !== dId) {
                let temp = squares[dId].innerHTML;
                squares[dId].innerHTML = squares[tId].innerHTML;
                squares[tId].innerHTML = temp;
                
                // Bomb Feature: 10% chance
                if (temp === 'üí£') {
                    explodeBomb(tId);
                } else {
                    checkMatches();
                }
            }
        }

        function explodeBomb(id) {
            const area = [id-1, id+1, id-width, id+width, id-width-1, id-width+1, id+width-1, id+width+1];
            area.forEach(idx => {
                if (squares[idx]) squares[idx].innerHTML = emojis[Math.floor(Math.random()*6)];
            });
            score += 200;
            updateUI("BOOM! üî•");
        }

        function checkMatches() {
            let found = false;
            for (let i = 0; i < width * height; i++) {
                let r3 = [i, i+1, i+2], c3 = [i, i+width, i+width*2];
                let current = squares[i].innerHTML;
                if (current === 'üí£') continue;

                if (i % width < width - 2 && r3.every(idx => squares[idx] && squares[idx].innerHTML === current)) {
                    score += 50; found = true;
                    r3.forEach(idx => squares[idx].innerHTML = Math.random() < 0.1 ? 'üí£' : emojis[Math.floor(Math.random()*6)]);
                }
                if (i < width * (height - 2) && c3.every(idx => squares[idx] && squares[idx].innerHTML === current)) {
                    score += 50; found = true;
                    c3.forEach(idx => squares[idx].innerHTML = Math.random() < 0.1 ? 'üí£' : emojis[Math.floor(Math.random()*6)]);
                }
            }
            if (found) updateUI(words[Math.floor(Math.random()*words.length)]);
        }

        function updateUI(text) {
            scoreDisplay.innerText = score;
            msg.innerText = text;
            msg.style.display = 'block';
            setTimeout(() => { msg.style.display = 'none'; checkMatches(); }, 600);
        }

        createBoard();
    </script>
</body>
</html>
