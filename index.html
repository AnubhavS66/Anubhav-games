<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Candy Crush Pro | Premium</title>
    <link href="https://fonts.googleapis.com" rel="stylesheet">
    <style>
        :root {
            --primary-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --candy-shadow: 0 4px 10px rgba(0,0,0,0.2);
            --board-bg: rgba(255, 255, 255, 0.1);
        }

        body {
            margin: 0;
            background: #0f0c29;
            background: linear-gradient(to bottom, #24243e, #302b63, #0f0c29);
            height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            font-family: 'Outfit', sans-serif;
            color: white;
            overflow: hidden;
            touch-action: none;
        }

        /* Top Bar Professional Style */
        .game-header {
            width: 90%;
            max-width: 400px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding: 15px;
            background: var(--board-bg);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            border: 1px solid rgba(255,255,255,0.1);
        }

        .stat-box { text-align: center; }
        .stat-label { font-size: 10px; text-transform: uppercase; letter-spacing: 2px; color: #aaa; }
        .stat-value { font-size: 24px; font-weight: 900; color: #00d2ff; }

        /* Professional Grid */
        #game-board {
            display: grid;
            grid-template-columns: repeat(8, 1fr);
            gap: 8px;
            padding: 10px;
            background: var(--board-bg);
            border-radius: 24px;
            box-shadow: 0 20px 50px rgba(0,0,0,0.5);
            border: 2px solid rgba(255,255,255,0.05);
            width: 90vw;
            height: 90vw;
            max-width: 400px;
            max-height: 400px;
        }

        .tile {
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 30px;
            cursor: pointer;
            user-select: none;
            transition: transform 0.1s ease;
            filter: drop-shadow(var(--candy-shadow));
        }

        .tile:active { transform: scale(0.9); }

        /* Popup Score Animation */
        .floating-text {
            position: absolute;
            pointer-events: none;
            font-weight: 900;
            color: #fff;
            text-shadow: 0 0 10px rgba(0,0,0,0.5);
            animation: floatUp 0.8s ease-out forwards;
            z-index: 100;
        }

        @keyframes floatUp {
            0% { transform: translateY(0) scale(0.5); opacity: 0; }
            50% { opacity: 1; }
            100% { transform: translateY(-100px) scale(1.5); opacity: 0; }
        }
    </style>
</head>
<body>

    <div class="game-header">
        <div class="stat-box">
            <div class="stat-label">Score</div>
            <div id="score" class="stat-value">0000</div>
        </div>
        <div class="stat-box">
            <div class="stat-label">Target</div>
            <div class="stat-value" style="color: #ff0078;">2500</div>
        </div>
    </div>

    <div id="game-board"></div>

    <script>
        class CandyCrush {
            constructor(containerId, scoreId) {
                this.board = document.getElementById(containerId);
                this.scoreDisplay = document.getElementById(scoreId);
                this.size = 8;
                this.candies = ['ðŸŽ', 'ðŸ‡', 'ðŸŠ', 'ðŸ‹', 'ðŸ’Ž', 'ðŸš€'];
                this.score = 0;
                this.tiles = [];
                this.init();
            }

            init() {
                this.createBoard();
                this.setupEvents();
                // Match check on start
                setInterval(() => this.checkMatches(), 100);
            }

            createBoard() {
                for (let i = 0; i < this.size * this.size; i++) {
                    const tile = document.createElement('div');
                    tile.classList.add('tile');
                    tile.setAttribute('draggable', true);
                    tile.setAttribute('id', i);
                    tile.innerHTML = this.getRandomCandy();
                    this.board.appendChild(tile);
                    this.tiles.push(tile);
                }
            }

            getRandomCandy() {
                return this.candies[Math.floor(Math.random() * this.candies.length)];
            }

            setupEvents() {
                let startTileId, startX, startY;

                this.board.addEventListener('touchstart', (e) => {
                    const target = e.target.closest('.tile');
                    if (!target) return;
                    startTileId = parseInt(target.id);
                    startX = e.touches[0].clientX;
                    startY = e.touches[0].clientY;
                });

                this.board.addEventListener('touchend', (e) => {
                    if (startTileId === undefined) return;
                    const endX = e.changedTouches[0].clientX;
                    const endY = e.changedTouches[0].clientY;
                    this.handleSwipe(startTileId, startX, startY, endX, endY);
                });
            }

            handleSwipe(id, sX, sY, eX, eY) {
                const deltaX = eX - sX;
                const deltaY = eY - sY;
                let targetId = id;

                if (Math.abs(deltaX) > Math.abs(deltaY)) {
                    if (deltaX > 30 && id % 8 !== 7) targetId = id + 1;
                    else if (deltaX < -30 && id % 8 !== 0) targetId = id - 1;
                } else {
                    if (deltaY > 30 && id < 56) targetId = id + 8;
                    else if (deltaY < -30 && id >= 8) targetId = id - 8;
                }

                if (targetId !== id) this.swapTiles(id, targetId);
            }

            swapTiles(id1, id2) {
                const temp = this.tiles[id1].innerHTML;
                this.tiles[id1].innerHTML = this.tiles[id2].innerHTML;
                this.tiles[id2].innerHTML = temp;
                
                // Feedback Haptic (if mobile)
                if (window.navigator.vibrate) window.navigator.vibrate(50);
            }

            checkMatches() {
                // Horizontal Match
                for (let i = 0; i < 62; i++) {
                    if (i % 8 > 5) continue;
                    let matchRange = [i, i+1, i+2];
                    let type = this.tiles[i].innerHTML;
                    if (type !== '' && matchRange.every(idx => this.tiles[idx].innerHTML === type)) {
                        this.processMatch(matchRange);
                    }
                }
                // Vertical Match
                for (let i = 0; i < 48; i++) {
                    let matchRange = [i, i+8, i+16];
                    let type = this.tiles[i].innerHTML;
                    if (type !== '' && matchRange.every(idx => this.tiles[idx].innerHTML === type)) {
                        this.processMatch(matchRange);
                    }
                }
            }

            processMatch(indices) {
                indices.forEach(idx => {
                    this.tiles[idx].innerHTML = '';
                    this.animatePop(this.tiles[idx]);
                });
                this.score += indices.length * 10;
                this.scoreDisplay.innerText = this.score.toString().padStart(4, '0');
                
                setTimeout(() => {
                    indices.forEach(idx => this.tiles[idx].innerHTML = this.getRandomCandy());
                }, 300);
            }

            animatePop(el) {
                const rect = el.getBoundingClientRect();
                const popup = document.createElement('div');
                popup.className = 'floating-text';
                popup.innerText = '+10';
                popup.style.left = `${rect.left + 10}px`;
                popup.style.top = `${rect.top}px`;
                document.body.appendChild(popup);
                setTimeout(() => popup.remove(), 800);
            }
        }

        // Initialize Game
        const game = new CandyCrush('game-board', 'score');
    </script>
</body>
</html>
